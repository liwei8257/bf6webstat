# 🎮 BF6玩家数据统计系统 - 使用说明

## 📋 系统特点

本系统支持**双模式运行**：

### 🔄 本地模式（开发环境）
- **实时查询**：直接从tracker.gg获取最新数据
- **即查即得**：点击刷新即可获取最新战绩
- **适合场景**：个人使用、频繁查询

### 📊 生产模式（Render部署）
- **静态快照**：读取预先导出的数据文件
- **快速加载**：无需等待API调用
- **适合场景**：公开分享、展示用途

系统会**自动检测环境**，无需手动切换！

---

## 🚀 使用流程

### 1️⃣ 本地查询（实时数据）

```bash
# 启动本地服务
cd D:\bf6stat
py app.py
```

访问 `http://localhost:5000`

- ✅ 点击"刷新数据"实时查询
- ✅ 数据完全是最新的
- ✅ 页面显示"🔄 开发模式：实时查询"

---

### 2️⃣ 更新线上数据（定期维护）

当你想更新Render上的数据时：

#### 方法A：双击运行（最简单）⭐

1. **双击 `update_data.bat`**
2. 等待数据导出完成
3. 自动提交并推送到GitHub
4. Render自动部署（1-2分钟）
5. 完成！

#### 方法B：手动执行

```bash
# 1. 导出数据
py export_data.py

# 2. 推送到GitHub
git add static/players_data.json
git commit -m "Update player data"
git push
```

---

### 3️⃣ 查看线上数据

访问你的Render URL：`https://bf6stat.onrender.com`

- ✅ 快速加载（读取静态文件）
- ✅ 显示上次更新时间
- ✅ 页面显示"📊 生产模式：静态数据"
- ✅ 不会被Cloudflare拦截

---

## 📅 更新频率建议

根据你的需求选择：

- **每天更新**：适合关注战绩变化
- **每周更新**：适合长期记录
- **随时更新**：重要比赛后立即更新

---

## 🔧 添加新玩家

### 步骤：

1. **在tracker.gg搜索玩家**
   - 访问：https://tracker.gg/battlefield-6
   - 搜索玩家名称

2. **获取玩家ID**
   - 从URL中复制ID
   - 例如：`tracker.gg/bf6/profile/steam/3116588130/overview`
   - ID就是：`3116588130`

3. **编辑 `players.json`**
   ```json
   {
       "players": [
           {
               "name": "新玩家名称",
               "platform": "steam",
               "user_id": "获取到的ID"
           }
       ]
   }
   ```

4. **本地测试**
   ```bash
   py app.py
   # 访问 localhost:5000 测试
   ```

5. **更新线上**
   ```bash
   双击 update_data.bat
   # 或手动运行上述命令
   ```

---

## 🎯 常见场景

### 场景1：每天查看自己的战绩

**使用本地模式**
```bash
py app.py
# 随时查看最新数据
```

### 场景2：分享给朋友查看

**使用Render模式**
```bash
# 每天或每周运行一次
双击 update_data.bat
# 分享Render URL给朋友
```

### 场景3：比赛期间实时关注

**使用本地模式**
```bash
py app.py
# 比赛后立即刷新查看
```

### 场景4：制作每周战绩总结

**使用Render模式**
```bash
# 每周日更新数据
双击 update_data.bat
# 截图或分享链接
```

---

## 📊 文件说明

```
bf6stat/
├── app.py                  # Web应用主程序
├── export_data.py          # 数据导出脚本
├── update_data.bat         # 一键更新脚本
├── players.json            # 玩家配置
└── static/
    └── players_data.json   # 导出的静态数据（自动生成）
```

---

## ⚙️ 配置选项

### players.json
```json
{
    "players": [
        {
            "name": "显示的名称",
            "platform": "steam",
            "user_id": "玩家ID"
        }
    ]
}
```

支持的平台：
- `steam` - Steam
- `origin` - Origin/EA
- `psn` - PlayStation
- `xbl` - Xbox

---

## 🔍 故障排除

### 本地模式遇到403错误？

1. 检查网络连接
2. 尝试添加延迟（已优化为3秒/玩家）
3. 检查cookies是否过期

### Render数据不更新？

1. 确认 `update_data.bat` 执行成功
2. 检查GitHub是否有新提交
3. 查看Render的Logs确认部署完成

### 数据显示异常？

1. 检查玩家ID是否正确
2. 确认玩家在tracker.gg有数据
3. 查看控制台错误信息

---

## 💡 高级技巧

### 自动化更新（可选）

使用Windows任务计划程序，每天自动运行 `update_data.bat`：

1. 打开"任务计划程序"
2. 创建基本任务
3. 设置每天运行
4. 操作：启动程序
5. 程序：`D:\bf6stat\update_data.bat`
6. 完成！

### 监控数据变化

可以在 `export_data.py` 中添加：
- 计算K/D变化
- 发送邮件通知
- 生成数据图表

---

## 📞 需要帮助？

如果遇到问题：
1. 查看控制台错误信息
2. 检查Render的Logs
3. 确认配置文件格式正确

祝使用愉快！🎉

