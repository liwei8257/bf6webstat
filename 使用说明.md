# 🎮 BF6玩家数据统计系统 - 使用说明

## 📋 系统特点

本系统支持**双模式运行**：

### 🔄 本地模式（开发环境）
- **实时查询**：直接从tracker.gg获取最新数据
- **即查即得**：点击刷新即可获取最新战绩
- **适合场景**：个人使用、频繁查询

### 📊 生产模式（Render部署）
- **静态快照**：读取预先导出的数据文件
- **快速加载**：无需等待API调用
- **适合场景**：公开分享、展示用途

系统会**自动检测环境**，无需手动切换！

---

## 🚀 使用流程

### 1️⃣ 本地查询（实时数据）

```bash
# 启动本地服务
cd D:\bf6stat
py app.py
```

访问 `http://localhost:5000`

- ✅ 点击"刷新数据"实时查询
- ✅ 数据完全是最新的
- ✅ 页面显示"🔄 开发模式：实时查询"

---

### 2️⃣ 更新线上数据（定期维护）

当你想更新Render上的数据时：

#### 方法A：双击运行（最简单）⭐

1. **双击 `update_data.bat`**
2. 等待数据导出完成
3. 自动提交并推送到GitHub
4. Render自动部署（1-2分钟）
5. 完成！

#### 方法B：手动执行

```bash
# 1. 导出数据
py export_data.py

# 2. 推送到GitHub
git add static/players_data.json
git commit -m "Update player data"
git push
```

---

### 3️⃣ 查看线上数据

访问你的Render URL：`https://bf6stat.onrender.com`

- ✅ 快速加载（读取静态文件）
- ✅ 显示上次更新时间
- ✅ 页面显示"📊 生产模式：静态数据"
- ✅ 不会被Cloudflare拦截

---

## 📅 更新频率建议

根据你的需求选择：

- **每天更新**：适合关注战绩变化
- **每周更新**：适合长期记录
- **随时更新**：重要比赛后立即更新

---

## 🔧 添加新玩家

### 步骤：

1. **在tracker.gg搜索玩家**
   - 访问：https://tracker.gg/battlefield-6
   - 搜索玩家名称

2. **获取玩家ID**
   - 从URL中复制ID
   - 例如：`tracker.gg/bf6/profile/steam/3116588130/overview`
   - ID就是：`3116588130`

3. **编辑 `players.json`**
   ```json
   {
       "players": [
           {
               "name": "新玩家名称",
               "platform": "steam",
               "user_id": "获取到的ID"
           }
       ]
   }
   ```

4. **本地测试**
   ```bash
   py app.py
   # 访问 localhost:5000 测试
   ```

5. **更新线上**
   ```bash
   双击 update_data.bat
   # 或手动运行上述命令
   ```

---

## 🆔 如何查找Steam ID（重要！）

### ⚠️ 注意
**Steam显示名称可以重复，但Steam ID是唯一的！** 本系统需要使用**Steam ID（数字）**，而不是Steam用户名。

### 方法1：通过tracker.gg查找（推荐）✨

1. 访问：https://tracker.gg/battlefield-2042
2. 点击右上角"Sign In"，用Steam登录
3. 登录后会自动跳转到你的个人资料页面
4. 从URL中获取你的Steam ID（一串数字）
5. 例如：`https://tracker.gg/battlefield-2042/profile/steam/76561198012345678/overview`
   - 你的Steam ID就是：`76561198012345678`

### 方法2：通过Steam个人资料查找

1. 打开Steam客户端
2. 点击右上角你的用户名 → "查看我的个人资料"
3. 在浏览器中打开后，URL类似：
   - `https://steamcommunity.com/profiles/76561198012345678/`
   - 或 `https://steamcommunity.com/id/你的自定义URL/`
4. 如果是数字结尾的URL，那串数字就是你的Steam ID
5. 如果是自定义URL，继续下一步...

### 方法3：通过第三方工具查找

如果你的Steam个人资料是自定义URL，使用以下网站转换：

1. 访问：https://steamid.io/ 或 https://steamidfinder.com/
2. 输入你的Steam个人资料链接或自定义URL
3. 获取你的 **Steam ID 64**（一串17位数字）
4. 这就是系统需要的ID

### 方法4：通过游戏内查找

1. 在浏览器打开：https://steamcommunity.com/my/
2. 登录后会自动跳转到你的个人资料
3. 从URL中获取Steam ID

### 📝 示例对比

| 类型 | 示例 | 说明 |
|------|------|------|
| ❌ Steam显示名称 | `ProGamer123` | 可重复，不能用 |
| ❌ 自定义URL | `mycustomname` | 需要转换 |
| ✅ Steam ID | `76561198012345678` | 唯一，系统需要这个 |

### 💡 添加玩家时的正确配置

```json
{
    "players": [
        {
            "name": "张三",           // 你想显示的任意名称
            "platform": "steam",
            "user_id": "76561198012345678"  // 必须是数字ID
        },
        {
            "name": "李四",
            "platform": "steam", 
            "user_id": "76561199000000000"  // 不是Steam用户名！
        }
    ]
}
```

---

## 🎯 常见场景

### 场景1：每天查看自己的战绩

**使用本地模式**
```bash
py app.py
# 随时查看最新数据
```

### 场景2：分享给朋友查看

**使用Render模式**
```bash
# 每天或每周运行一次
双击 update_data.bat
# 分享Render URL给朋友
```

### 场景3：比赛期间实时关注

**使用本地模式**
```bash
py app.py
# 比赛后立即刷新查看
```

### 场景4：制作每周战绩总结

**使用Render模式**
```bash
# 每周日更新数据
双击 update_data.bat
# 截图或分享链接
```

---

## 📊 文件说明

```
bf6stat/
├── app.py                  # Web应用主程序
├── export_data.py          # 数据导出脚本
├── update_data.bat         # 一键更新脚本
├── players.json            # 玩家配置
└── static/
    └── players_data.json   # 导出的静态数据（自动生成）
```

---

## ⚙️ 配置选项

### players.json
```json
{
    "players": [
        {
            "name": "显示的名称",
            "platform": "steam",
            "user_id": "玩家ID"
        }
    ]
}
```

支持的平台：
- `steam` - Steam
- `origin` - Origin/EA
- `psn` - PlayStation
- `xbl` - Xbox

---

## 🔍 故障排除

### 本地模式遇到403错误？

1. 检查网络连接
2. 尝试添加延迟（已优化为3秒/玩家）
3. 检查cookies是否过期

### Render数据不更新？

1. 确认 `update_data.bat` 执行成功
2. 检查GitHub是否有新提交
3. 查看Render的Logs确认部署完成

### 数据显示异常？

1. 检查玩家ID是否正确
2. 确认玩家在tracker.gg有数据
3. 查看控制台错误信息

---

## 💡 高级技巧

### 自动化更新（可选）

使用Windows任务计划程序，每天自动运行 `update_data.bat`：

1. 打开"任务计划程序"
2. 创建基本任务
3. 设置每天运行
4. 操作：启动程序
5. 程序：`D:\bf6stat\update_data.bat`
6. 完成！

### 监控数据变化

可以在 `export_data.py` 中添加：
- 计算K/D变化
- 发送邮件通知
- 生成数据图表

---

## 📞 需要帮助？

如果遇到问题：
1. 查看控制台错误信息
2. 检查Render的Logs
3. 确认配置文件格式正确

祝使用愉快！🎉

