# 📊 静态数据快照方案

## 方案说明

既然Render不能实时获取数据，可以改为：
1. 本地定期更新数据
2. 生成JSON快照
3. 推送到GitHub
4. Render读取静态数据

## 优点

- ✅ Render不需要访问tracker.gg
- ✅ 页面加载极快
- ✅ 不受Cloudflare限制
- ✅ 完全免费

## 缺点

- ❌ 数据不是实时的
- ❌ 需要手动更新（或定时任务）

## 实现步骤

### 1. 创建数据导出脚本

```python
# export_data.py
import asyncio
import json
from data_processor import fetch_all_players_data

async def export():
    data = await fetch_all_players_data()
    with open('static/players_data.json', 'w', encoding='utf-8') as f:
        json.dump({
            'timestamp': int(time.time()),
            'data': data
        }, f, ensure_ascii=False, indent=2)
    print('数据已导出到 static/players_data.json')

if __name__ == '__main__':
    asyncio.run(export())
```

### 2. 本地更新数据

```bash
# 每天手动运行一次
py export_data.py
git add static/players_data.json
git commit -m "Update player data"
git push
```

### 3. 修改前端读取静态文件

```javascript
// 读取静态JSON而不是调用API
fetch('/static/players_data.json')
    .then(r => r.json())
    .then(result => {
        playersData = result.data;
        renderTable(playersData);
        
        // 显示更新时间
        const updateTime = new Date(result.timestamp * 1000);
        document.getElementById('updateTime').textContent = 
            `数据更新时间: ${updateTime.toLocaleString()}`;
    });
```

### 4. 自动化（可选）

使用GitHub Actions每小时自动更新：

```yaml
# .github/workflows/update-data.yml
name: Update Player Data

on:
  schedule:
    - cron: '0 * * * *'  # 每小时运行
  workflow_dispatch:  # 手动触发

jobs:
  update:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - uses: actions/setup-python@v2
      - run: pip install -r requirements.txt
      - run: python export_data.py
      - run: |
          git config user.name github-actions
          git config user.email github-actions@github.com
          git add static/players_data.json
          git commit -m "Auto update data"
          git push
```

## 适用场景

- 个人查看（不需要实时）
- 朋友间分享战绩
- 定期更新就够用

## 总结

这是最**稳定**且**免费**的方案，适合不需要实时数据的场景。

